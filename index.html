<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DBD Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #1c1c1c;
      color: #ffffff;
    }
    h1 {
      text-align: center;
    }
    h2 {
      text-align: center;
    }
    label, input, select, button {
      margin: 10px 0;
      color: #ffffff;
      background-color: #333333;
      border: 1px solid #555555;
      padding: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    table, th, td {
      border: 1px solid #555555;
    }
    th, td {
      padding: 10px;
      text-align: center;
    }
    pre {
      border: 1px solid #555555;
      padding: 10px;
      background-color: #333333;
      color: #ffffff;
      white-space: pre-wrap;
    }
    button:hover {
      background-color: #444444;
    }
    .notification {
      text-align: center;
      margin: 10px 0;
      color: #00ff00;
    }
    .export-import {
      position: absolute;
      top: 10px;
      right: 10px;
    }
  </style>
</head>
<body>
  <h1>DBD Tracker</h1>
  <p style="text-align: center; font-size: 14px;">A simple Website to keep Track of your DBD Challenges/Streaks. No login necessary. Stats saved in your Browser's Local Storage<br>
  For feedback or ideas add "sleepingalot" on Discord or Steam!</p>

  <div id="notification" class="notification"></div>

  <!-- Export/Import Buttons -->
  <div class="export-import">
    <button onclick="exportData()">Export Data</button>
    <button onclick="importData()">Import Data</button>
  </div>

  <!-- Dropdown for Challenges / Streaks -->
  <label for="challengeSelect">Select a Challenge / Streak:</label>
  <select id="challengeSelect"></select>

  <!-- Enter Progress -->
  <label for="progressInput">Progress:</label>
  <input id="progressInput" type="number" min="1" max="9999" />
  <button onclick="updateProgress()">Save</button>
  <button onclick="deleteChallenge()">Delete Challenge / Streak</button>

  <!-- Add New Challenge / Streak -->
  <h2>Add New Challenge / Streak</h2>
  <label for="newChallenge">Name:</label>
  <input id="newChallenge" type="text" />
  <button onclick="addChallenge()">Add</button>

  <!-- Sorted Challenge / Streak List -->
  <h2>Challenge / Streak List</h2>
  <button onclick="sortByName()">Sort by Name</button>
  <button onclick="sortByProgress()">Sort by Progress</button>
  <button onclick="sortByRecent()">Sort by Recent</button>
  <pre id="challengeList"></pre>
  <button onclick="resetPersonalBest()">Reset all Best Values</button>

  <script>
    // Store data in LocalStorage
    const defaultChallenges = ['Survivor Escape Streak', 'Killer Win Streak', 'Copy Cat Challenge', 'Random Perk Streak', 'Random Killer Streak'];
    const challenges = JSON.parse(localStorage.getItem('challenges')) || defaultChallenges;
    const progress = JSON.parse(localStorage.getItem('progress')) || {};
    const personalBest = JSON.parse(localStorage.getItem('personalBest')) || {};
    const timestamps = JSON.parse(localStorage.getItem('timestamps')) || {};

    const challengeSelect = document.getElementById('challengeSelect');
    const challengeList = document.getElementById('challengeList');
    const notification = document.getElementById('notification');

    function showNotification(message) {
      notification.textContent = message;
      setTimeout(() => notification.textContent = '', 3000);
    }

    function exportData() {
      const data = {
        challenges,
        progress,
        personalBest,
        timestamps
      };
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
      const downloadAnchor = document.createElement('a');
      downloadAnchor.setAttribute("href", dataStr);
      downloadAnchor.setAttribute("download", "dbd_tracker_data.json");
      document.body.appendChild(downloadAnchor);
      downloadAnchor.click();
      document.body.removeChild(downloadAnchor);
      showNotification('Data exported successfully!');
    }

    function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'application/json';
      input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (event) => {
          const importedData = JSON.parse(event.target.result);
          localStorage.setItem('challenges', JSON.stringify(importedData.challenges));
          localStorage.setItem('progress', JSON.stringify(importedData.progress));
          localStorage.setItem('personalBest', JSON.stringify(importedData.personalBest));
          localStorage.setItem('timestamps', JSON.stringify(importedData.timestamps));
          window.location.reload();
        };
        reader.readAsText(file);
      };
      input.click();
      showNotification('Data imported successfully!');
    }

    updateDropdown();
    updateChallengeList();
  </script>

  <h2 style="text-align: center; margin-top: 20px;">Made by sleepingalot</h2>
  <p style="text-align: center; font-size: 12px; margin-top: 50px;">Note: Data may be lost when clearing cache or browser history. Using private/incognito mode or switching browsers may not retain data. It is recommended to regularly export your dataâ€”just to be safe!</p>
</body>
</html>
